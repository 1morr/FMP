# Flutter Music Player (FMP) - äº§å“éœ€æ±‚æ–‡æ¡£

> ç‰ˆæœ¬: 1.1.0
> åˆ›å»ºæ—¥æœŸ: 2026-01-03
> æœ€åæ›´æ–°: 2026-02-09
> çŠ¶æ€: å¼€å‘å®Œå–„é˜¶æ®µ (Phase 1-5 âœ… å¤§éƒ¨åˆ†å®Œæˆ, Phase 6 â³ å¾…å¼€å§‹)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 äº§å“æ„¿æ™¯

æ„å»ºä¸€ä¸ªè·¨å¹³å°éŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒä» Bilibili å’Œ YouTube è·å–éŸ³æºï¼Œæä¾›ç»Ÿä¸€çš„æ’­æ”¾ä½“éªŒï¼Œæ”¯æŒç¦»çº¿æ’­æ”¾ã€å¤§è§„æ¨¡æ’­æ”¾é˜Ÿåˆ—ç®¡ç†å’Œå®Œæ•´çš„éŸ³ä¹åº“åŠŸèƒ½ã€‚

### 1.2 ç›®æ ‡ç”¨æˆ·

ä¸ªäººä½¿ç”¨ï¼Œç”¨äºæ•´åˆä¸åŒå¹³å°çš„éŸ³ä¹èµ„æºåˆ°ç»Ÿä¸€çš„æ’­æ”¾ä½“éªŒä¸­ã€‚

### 1.3 ç›®æ ‡å¹³å°

| ä¼˜å…ˆçº§ | å¹³å° | çŠ¶æ€ |
|--------|------|------|
| MVP | Android | âœ… å·²å®ç° |
| MVP | Windows | âœ… å·²å®ç° |
| æœªæ¥ | iOS | ğŸ”® å¯é€‰ |
| æœªæ¥ | Linux | ğŸ”® å¯é€‰ |
| æœªæ¥ | macOS | ğŸ”® å¯é€‰ |

---

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 éŸ³æºé›†æˆ

#### 2.1.1 æ”¯æŒçš„éŸ³æº
- **Bilibili**: è§†é¢‘/éŸ³é¢‘å†…å®¹ âœ… å·²å®ç°
- **YouTube**: è§†é¢‘/éŸ³é¢‘å†…å®¹ âœ… å·²å®ç°ï¼ˆä½¿ç”¨ youtube_explode_dart + InnerTube APIï¼‰

#### 2.1.2 éŸ³æºç‰¹æ€§
| ç‰¹æ€§ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| è®¤è¯ | æ— éœ€ç™»å½•ï¼Œä»…è®¿é—®å…¬å¼€å†…å®¹ | âœ… |
| éŸ³è´¨è®¾ç½® | ç”¨æˆ·å¯é…ç½®éŸ³è´¨ç­‰çº§ï¼ˆé«˜/ä¸­/ä½ï¼‰ã€æ ¼å¼ä¼˜å…ˆçº§ã€æµç±»å‹ä¼˜å…ˆçº§ | âœ… |
| ç¦»çº¿æ’­æ”¾ | æ”¯æŒä¸‹è½½ç¼“å­˜ | âœ… |
| YouTube Mix | æ”¯æŒ YouTube Mix/Radio åŠ¨æ€æ’­æ”¾åˆ—è¡¨ | âœ… |

#### 2.1.3 éŸ³é¢‘è´¨é‡è®¾ç½®
| è®¾ç½®é¡¹ | è¯´æ˜ | é€‚ç”¨éŸ³æº |
|--------|------|----------|
| éŸ³è´¨ç­‰çº§ | é«˜/ä¸­/ä½ç ç‡é€‰æ‹© | å…¨éƒ¨ |
| æ ¼å¼ä¼˜å…ˆçº§ | Opus/AAC ä¼˜å…ˆé¡ºåº | ä»… YouTube |
| æµç±»å‹ä¼˜å…ˆçº§ | çº¯éŸ³é¢‘/æ··åˆæµ/HLS | YouTube/Bilibili |

### 2.2 é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 App                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚é¦–é¡µ â”‚ â”‚æ¢ç´¢ â”‚ â”‚æœç´¢ â”‚ â”‚éŸ³ä¹åº“â”‚ â”‚è®¾ç½® â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜â”‚
â”‚              â”‚                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚    â”‚         â”‚         â”‚                 â”‚
â”‚ â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”             â”‚
â”‚ â”‚æ’­æ”¾å™¨â”‚ â”‚æ’­æ”¾é˜Ÿåˆ—â”‚ â”‚æ­Œå•è¯¦æƒ…â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.1 é¦–é¡µ (Home)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| å¿«æ·æ“ä½œ | æœç´¢ã€éŸ³ä¹åº“ã€æ’­æ”¾é˜Ÿåˆ—å¿«æ·å…¥å£ | âœ… |
| URL æ’­æ”¾ | è¾“å…¥ Bilibili/YouTube URL ç›´æ¥æ’­æ”¾ | âœ… |
| å½“å‰æ’­æ”¾ | æ˜¾ç¤ºæ­£åœ¨æ’­æ”¾çš„æ­Œæ›²å¡ç‰‡ | âœ… |
| æœ€è¿‘çƒ­é—¨ | Bilibili/YouTube éŸ³ä¹æ’è¡Œæ¦œé¢„è§ˆï¼ˆå‰10é¦–ï¼‰ | âœ… |
| æœ€è¿‘æ­Œå• | æ¨ªå‘å±•ç¤ºæœ€è¿‘ä½¿ç”¨çš„æ­Œå• | âœ… |
| æ¥ä¸‹æ¥æ’­æ”¾ | é˜Ÿåˆ—ä¸­æ¥ä¸‹æ¥çš„æ­Œæ›²é¢„è§ˆ | âœ… |

#### 2.2.2 æ¢ç´¢é¡µ (Explore) - æ–°å¢
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æ’è¡Œæ¦œ | Bilibili/YouTube å®Œæ•´éŸ³ä¹æ’è¡Œæ¦œ | âœ… |
| Tab åˆ‡æ¢ | Bilibili/YouTube åˆ† Tab æ˜¾ç¤º | âœ… |
| ä¸‹æ‹‰åˆ·æ–° | åˆ·æ–°æ’è¡Œæ¦œæ•°æ® | âœ… |
| ç¼“å­˜æœºåˆ¶ | åå°æ¯å°æ—¶è‡ªåŠ¨åˆ·æ–°ç¼“å­˜ | âœ… |

#### 2.2.3 æœç´¢é¡µ (Search)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| å¤šæºæœç´¢ | åŒæ—¶æœç´¢ Bilibili å’Œ YouTube | âœ… |
| éŸ³æºç­›é€‰ | å¯é€‰æ‹©ç‰¹å®šéŸ³æºè¿›è¡Œè¿‡æ»¤ | âœ… |
| æœç´¢å†å² | ä¿å­˜å¹¶å±•ç¤ºå†å²æœç´¢è®°å½• | âœ… |
| ç»“æœæ“ä½œ | ç›´æ¥æ’­æ”¾ / åŠ å…¥é˜Ÿåˆ— / æ·»åŠ åˆ°æ­Œå• | âœ… |
| å¤šPå±•å¼€ | Bilibili å¤šPè§†é¢‘å¯å±•å¼€æ˜¾ç¤ºå„åˆ†P | âœ… |
| æ— é™æ»šåŠ¨ | æ»šåŠ¨åŠ è½½æ›´å¤šç»“æœ | âœ… |

#### 2.2.4 æ’­æ”¾å™¨é¡µ (Player)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æ’­æ”¾æ§åˆ¶ | æ’­æ”¾/æš‚åœã€ä¸Šä¸€é¦–/ä¸‹ä¸€é¦– | âœ… |
| è¿›åº¦æ§åˆ¶ | æ‹–åŠ¨è¿›åº¦æ¡ + å¿«è¿›å¿«é€€æŒ‰é’®ï¼ˆÂ±10ç§’ï¼‰ | âœ… |
| æ’­æ”¾é€Ÿåº¦ | æ”¯æŒ 0.5x - 2.0x è°ƒèŠ‚ | âœ… |
| æ’­æ”¾æ¨¡å¼ | é¡ºåº / å•æ›²å¾ªç¯ / åˆ—è¡¨å¾ªç¯ / éšæœº | âœ… |
| æ–­ç‚¹ç»­æ’­ | é•¿è§†é¢‘ï¼ˆ>10åˆ†é’Ÿï¼‰è‡ªåŠ¨è®°ä½æ’­æ”¾ä½ç½® | âœ… |
| éŸ³é‡æ§åˆ¶ | æ¡Œé¢ç«¯éŸ³é‡æ»‘å— + é™éŸ³åˆ‡æ¢ | âœ… |
| éŸ³é¢‘ä¿¡æ¯ | æ˜¾ç¤ºç ç‡ã€æ ¼å¼ã€æµç±»å‹ç­‰æŠ€æœ¯å‚æ•° | âœ… |

#### 2.2.5 æ’­æ”¾é˜Ÿåˆ—é¡µ (Queue)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| å®¹é‡ | æ”¯æŒä¸Šåƒé¦–æ­Œæ›² | âœ… |
| æŒä¹…åŒ– | é‡å¯åº”ç”¨åä¿æŒé˜Ÿåˆ— | âœ… |
| æ‹–æ‹½æ’åº | æ”¯æŒæ‹–åŠ¨è°ƒæ•´é¡ºåº | âœ… |
| å·¦æ»‘åˆ é™¤ | Dismissible åˆ é™¤å•æ›² | âœ… |
| è‡ªåŠ¨å®šä½ | è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ’­æ”¾ä½ç½® | âœ… |
| Mix æ¨¡å¼ | YouTube Mix æ’­æ”¾åˆ—è¡¨ç‰¹æ®Šæ˜¾ç¤º | âœ… |

#### 2.2.6 éŸ³ä¹åº“é¡µ (Library)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æ­Œå•ç½‘æ ¼ | å“åº”å¼ç½‘æ ¼æ˜¾ç¤ºæ­Œå• | âœ… |
| æ··åˆéŸ³æº | åŒä¸€æ­Œå•å¯æ·»åŠ ä¸åŒéŸ³æºçš„æ­Œæ›² | âœ… |
| å¯¼å…¥æ­Œå• | ä» Bç«™æ”¶è—å¤¹ / YouTube æ’­æ”¾åˆ—è¡¨ URL å¯¼å…¥ | âœ… |
| æ­Œå•åˆ·æ–° | æ‰‹åŠ¨åˆ·æ–°å¯¼å…¥æ­Œå• | âœ… |
| å·²ä¸‹è½½å…¥å£ | å¿«é€Ÿè®¿é—®å·²ä¸‹è½½å†…å®¹ | âœ… |
| é•¿æŒ‰èœå• | æ·»åŠ åˆ°é˜Ÿåˆ—ã€ç¼–è¾‘ã€åˆ é™¤ç­‰æ“ä½œ | âœ… |

#### 2.2.7 æ­Œå•è¯¦æƒ…é¡µ (Playlist Detail)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æŠ˜å å¤´éƒ¨ | SliverAppBar æ˜¾ç¤ºå°é¢å’Œä¿¡æ¯ | âœ… |
| å¤šPåˆ†ç»„ | Bilibili å¤šPè§†é¢‘åˆ†ç»„æ˜¾ç¤º | âœ… |
| æ‰¹é‡æ“ä½œ | æ·»åŠ æ‰€æœ‰ã€éšæœºæ·»åŠ ã€ä¸‹è½½å…¨éƒ¨ | âœ… |
| ä¸‹è½½æ ‡è®° | å·²ä¸‹è½½æ­Œæ›²æ˜¾ç¤ºå›¾æ ‡ | âœ… |

#### 2.2.8 å·²ä¸‹è½½é¡µ (Downloaded)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| åˆ†ç±»ç½‘æ ¼ | æŒ‰æ­Œå•åˆ†æ–‡ä»¶å¤¹æ˜¾ç¤º | âœ… |
| æœ¬åœ°æ‰«æ | ç›´æ¥æ‰«ææ–‡ä»¶ç³»ç»Ÿï¼Œä¸ä¾èµ–æ•°æ®åº“ | âœ… |
| åŒæ­¥åŠŸèƒ½ | åŒæ­¥æœ¬åœ°æ–‡ä»¶åˆ°æ•°æ®åº“ | âœ… |

#### 2.2.9 è®¾ç½®é¡µ (Settings)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| ä¸»é¢˜ | æ·±è‰²/æµ…è‰²/è·Ÿéšç³»ç»Ÿ | âœ… |
| éŸ³é¢‘è®¾ç½® | éŸ³è´¨ç­‰çº§ã€æ ¼å¼ä¼˜å…ˆçº§ã€æµç±»å‹ä¼˜å…ˆçº§ | âœ… |
| ä¸‹è½½ç®¡ç† | ä¸‹è½½ä»»åŠ¡åˆ—è¡¨ã€è¿›åº¦æ˜¾ç¤º | âœ… |
| ä¸‹è½½è·¯å¾„ | è‡ªå®šä¹‰ä¸‹è½½ç›®å½•ï¼ˆWindowsï¼‰ | âœ… |
| æ¡Œé¢è®¾ç½® | æœ€å°åŒ–åˆ°æ‰˜ç›˜ã€å…¨å±€å¿«æ·é”®å¼€å…³ | âœ… |
| æ£€æŸ¥æ›´æ–° | åº”ç”¨å†…æ£€æŸ¥å’Œå®‰è£…æ›´æ–° | âœ… |
| å…³äº | ç‰ˆæœ¬ä¿¡æ¯ã€å¼€æºè®¸å¯ | âœ… |

### 2.3 æ ¸å¿ƒæ’­æ”¾åŠŸèƒ½

#### 2.3.1 ä¸´æ—¶æ’­æ”¾
| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| è§¦å‘æ–¹å¼ | æœç´¢é¡µ/æ­Œå•é¡µç‚¹å‡»æ­Œæ›² |
| è¡Œä¸º | ä¸´æ—¶æ’­æ”¾è¯¥æ­Œæ›²ï¼Œä¸ä¿®æ”¹å½“å‰é˜Ÿåˆ— |
| å®Œæˆå | è‡ªåŠ¨æ¢å¤åŸé˜Ÿåˆ—ä½ç½®ï¼ˆå›é€€10ç§’ï¼‰ |
| å•æ›²å¾ªç¯ | å¦‚è®¾ç½®å•æ›²å¾ªç¯ï¼Œä¸´æ—¶æ’­æ”¾æ­Œæ›²ä¼šç»§ç»­å¾ªç¯ |

#### 2.3.2 é™éŸ³åˆ‡æ¢
| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| è®°å¿†éŸ³é‡ | é™éŸ³å‰è®°ä½å½“å‰éŸ³é‡ |
| æ¢å¤éŸ³é‡ | å–æ¶ˆé™éŸ³æ—¶æ¢å¤åŸéŸ³é‡ |
| è°ƒç”¨æ–¹å¼ | å¿…é¡»ä½¿ç”¨ `toggleMute()`ï¼Œä¸èƒ½ç›´æ¥ `setVolume(0)` |

#### 2.3.3 è®°ä½æ’­æ”¾ä½ç½®
| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| è§¦å‘æ¡ä»¶ | è§†é¢‘æ—¶é•¿ > 10 åˆ†é’Ÿ ä¸” æ’­æ”¾è¿›åº¦ > 5% |
| å­˜å‚¨ä½ç½® | Track.rememberedPositionMs |
| æ¢å¤æ—¶æœº | ä¸‹æ¬¡æ’­æ”¾è¯¥æ­Œæ›²æ—¶è‡ªåŠ¨ seek åˆ°è®°å¿†ä½ç½® |

#### 2.3.4 YouTube Mix/Radio æ’­æ”¾
| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| è¯†åˆ«æ–¹å¼ | æ’­æ”¾åˆ—è¡¨ ID ä»¥ "RD" å¼€å¤´ |
| ç‰¹æ€§ | åŠ¨æ€æ— é™æ’­æ”¾åˆ—è¡¨ï¼Œè‡ªåŠ¨åŠ è½½æ›´å¤š |
| é™åˆ¶ | ç¦ç”¨éšæœºæ’­æ”¾ã€ç¦æ­¢æ·»åŠ åˆ°é˜Ÿåˆ— |
| æŒä¹…åŒ– | Mix çŠ¶æ€è·¨åº”ç”¨é‡å¯ä¿ç•™ |

### 2.4 å¹³å°ç‰¹æ€§

#### 2.4.1 ç§»åŠ¨ç«¯ (Android)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| åå°æ’­æ”¾ | é”å±/åˆ‡æ¢åº”ç”¨æ—¶ç»§ç»­æ’­æ”¾ | âœ… |
| é€šçŸ¥æ æ§åˆ¶ | æ˜¾ç¤ºå½“å‰æ­Œæ›²ä¿¡æ¯å’Œæ§åˆ¶æŒ‰é’®ï¼ˆä¸Šä¸€é¦–/ä¸‹ä¸€é¦–ï¼‰ | âœ… |
| è€³æœºæ§åˆ¶ | æ”¯æŒçº¿æ§æ’­æ”¾/æš‚åœ | âœ… |
| è€³æœºæ‹”å‡º | è‡ªåŠ¨æš‚åœæ’­æ”¾ | âœ… |
| å­˜å‚¨æƒé™ | ä½¿ç”¨ MANAGE_EXTERNAL_STORAGE è®¿é—®å¤–éƒ¨å­˜å‚¨ | âœ… |

#### 2.4.2 æ¡Œé¢ç«¯ (Windows)
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| ç³»ç»Ÿæ‰˜ç›˜ | æœ€å°åŒ–åˆ°æ‰˜ç›˜ï¼Œæ‰˜ç›˜èœå•æ§åˆ¶ | âœ… |
| å…¨å±€å¿«æ·é”® | æ’­æ”¾/æš‚åœã€ä¸Šä¸€é¦–/ä¸‹ä¸€é¦– | âœ… |
| åª’ä½“é”® | æ”¯æŒé”®ç›˜åª’ä½“é”®æ§åˆ¶ï¼ˆSMTCï¼‰ | âœ… |
| çª—å£è®°å¿† | è®°ä½çª—å£ä½ç½®å’Œå¤§å° | âœ… |
| åº”ç”¨æ›´æ–° | ä¸‹è½½ ZIP å¹¶é™é»˜æ›´æ–° | âœ… |

### 2.5 ä¸‹è½½ç³»ç»Ÿ

#### 2.5.1 ä¸‹è½½åŠŸèƒ½
| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| å•æ›²ä¸‹è½½ | ä¸‹è½½å•é¦–æ­Œæ›² | âœ… |
| æ‰¹é‡ä¸‹è½½ | ä¸‹è½½æ•´ä¸ªæ­Œå• | âœ… |
| å¹¶å‘æ§åˆ¶ | é»˜è®¤ 3 ä¸ªå¹¶å‘ä¸‹è½½ | âœ… |
| è¿›åº¦æ˜¾ç¤º | å®æ—¶æ˜¾ç¤ºä¸‹è½½è¿›åº¦ | âœ… |
| æ–­ç‚¹ç»­ä¼  | æ”¯æŒæš‚åœå’Œæ¢å¤ | âœ… |
| Isolate ä¸‹è½½ | Windows ä½¿ç”¨ç‹¬ç«‹è¿›ç¨‹ä¸‹è½½é¿å…å¡é¡¿ | âœ… |

#### 2.5.2 æ–‡ä»¶ç»“æ„
```
{ä¸‹è½½è·¯å¾„}/
â”œâ”€â”€ {æ­Œå•å}/
â”‚   â”œâ”€â”€ playlist_cover.jpg
â”‚   â”œâ”€â”€ {sourceId}_{è§†é¢‘æ ‡é¢˜}/
â”‚   â”‚   â”œâ”€â”€ metadata.json / metadata_P{NN}.json
â”‚   â”‚   â”œâ”€â”€ cover.jpg
â”‚   â”‚   â”œâ”€â”€ audio.m4a / P{NN}.m4a
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ...
â””â”€â”€ æœªåˆ†ç±»/
```

### 2.6 åº”ç”¨æ›´æ–°

| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æ£€æŸ¥æ›´æ–° | é€šè¿‡ GitHub Releases API | âœ… |
| ç‰ˆæœ¬æ¯”è¾ƒ | è¯­ä¹‰åŒ–ç‰ˆæœ¬æ¯”è¾ƒ | âœ… |
| Android å®‰è£… | ä¸‹è½½ APK å¹¶è°ƒç”¨ç³»ç»Ÿå®‰è£…å™¨ | âœ… |
| Windows å®‰è£… | ä¸‹è½½ ZIPï¼Œè§£å‹å¹¶é™é»˜æ›¿æ¢ | âœ… |

---

## 3. æ•°æ®æ¨¡å‹

### 3.1 Track (æ­Œæ›²)
```dart
class Track {
  int id;                    // æœ¬åœ°æ•°æ®åº“ ID
  String sourceId;           // æºå¹³å° ID (å¦‚ BVå·)
  SourceType sourceType;     // éŸ³æºç±»å‹ (bilibili/youtube)
  String title;              // æ ‡é¢˜
  String? artist;            // è‰ºæœ¯å®¶/UPä¸»
  String? thumbnailUrl;      // å°é¢ URL
  int? durationMs;           // æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
  int? cid;                  // Bilibili cid
  int? pageNum;              // å¤šPè§†é¢‘çš„åˆ†Påºå·
  String? parentTitle;       // å¤šPè§†é¢‘çš„çˆ¶æ ‡é¢˜
  List<int> playlistIds;     // å…³è”çš„æ­Œå• ID åˆ—è¡¨
  List<String> downloadPaths; // ä¸‹è½½è·¯å¾„åˆ—è¡¨ï¼ˆæŒ‰æ­Œå•ï¼‰
  int? rememberedPositionMs; // è®°å¿†çš„æ’­æ”¾ä½ç½®
  DateTime createdAt;        // åˆ›å»ºæ—¶é—´
  DateTime? lastPlayedAt;    // æœ€åæ’­æ”¾æ—¶é—´
}
```

### 3.2 Playlist (æ­Œå•)
```dart
class Playlist {
  int id;
  String name;               // æ­Œå•åç§°
  String? description;       // æè¿°
  String? coverUrl;          // å°é¢ URL
  bool isImported;           // æ˜¯å¦ä¸ºå¯¼å…¥æ­Œå•
  String? sourceUrl;         // å¯¼å…¥æº URL
  SourceType? sourceType;    // å¯¼å…¥æºç±»å‹
  DateTime createdAt;
  DateTime? lastSyncedAt;    // æœ€ååŒæ­¥æ—¶é—´
}
```

### 3.3 PlayQueue (æ’­æ”¾é˜Ÿåˆ—)
```dart
class PlayQueue {
  int id;
  List<int> trackIds;        // é˜Ÿåˆ—ä¸­çš„æ­Œæ›² ID åˆ—è¡¨
  int currentIndex;          // å½“å‰æ’­æ”¾ç´¢å¼•
  bool isShuffled;           // æ˜¯å¦éšæœºæ¨¡å¼
  LoopMode loopMode;         // å¾ªç¯æ¨¡å¼
  Duration? savedPosition;   // ä¿å­˜çš„æ’­æ”¾ä½ç½®
  double volume;             // éŸ³é‡ (0.0-1.0)
  // Mix æ¨¡å¼ç›¸å…³
  bool isMixMode;            // æ˜¯å¦ Mix æ’­æ”¾æ¨¡å¼
  String? mixPlaylistId;     // Mix æ’­æ”¾åˆ—è¡¨ ID
  String? mixSeedVideoId;    // Mix ç§å­è§†é¢‘ ID
  String? mixTitle;          // Mix æ ‡é¢˜
}
```

### 3.4 Settings (è®¾ç½®)
```dart
class Settings {
  int id;
  int themeModeIndex;        // ä¸»é¢˜æ¨¡å¼ç´¢å¼•
  String? downloadPath;      // ä¸‹è½½è·¯å¾„
  bool minimizeToTray;       // æœ€å°åŒ–åˆ°æ‰˜ç›˜
  bool globalHotkeysEnabled; // å…¨å±€å¿«æ·é”®å¼€å…³
  bool autoScrollToCurrentTrack; // è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ­Œæ›²
  // éŸ³é¢‘è®¾ç½®
  int audioQualityLevelIndex;    // éŸ³è´¨ç­‰çº§
  String audioFormatPriority;    // æ ¼å¼ä¼˜å…ˆçº§
  String youtubeStreamPriority;  // YouTube æµä¼˜å…ˆçº§
  String bilibiliStreamPriority; // Bilibili æµä¼˜å…ˆçº§
}
```

### 3.5 DownloadTask (ä¸‹è½½ä»»åŠ¡)
```dart
class DownloadTask {
  int id;
  int trackId;               // å…³è”çš„æ­Œæ›² ID
  int? playlistId;           // å…³è”çš„æ­Œå• ID
  String savePath;           // ä¿å­˜è·¯å¾„
  DownloadStatus status;     // çŠ¶æ€ (pending/downloading/completed/failed/paused)
  double progress;           // è¿›åº¦ (0.0-1.0)
  String? errorMessage;      // é”™è¯¯ä¿¡æ¯
  DateTime createdAt;
  DateTime? completedAt;
}
```

### 3.6 æšä¸¾ç±»å‹
```dart
enum SourceType { bilibili, youtube }

enum LoopMode { off, one, all }

enum PlayMode { queue, temporary, detached, mix }

enum AudioQualityLevel { high, medium, low }

enum AudioFormat { opus, aac }

enum StreamType { audioOnly, muxed, hls }

enum DownloadStatus { pending, downloading, completed, failed, paused }
```

---

## 4. ç”¨æˆ·ç•Œé¢

### 4.1 å“åº”å¼å¸ƒå±€

| å¸ƒå±€ | å®½åº¦ | å¯¼èˆª | è¯¦æƒ…é¢æ¿ |
|------|------|------|----------|
| Mobile | < 600dp | åº•éƒ¨ NavigationBar | æ—  |
| Tablet | 600-840dp | ä¾§è¾¹ NavigationRail | æ—  |
| Desktop | > 840dp | å¯æ”¶èµ·ä¾§è¾¹å¯¼èˆª | æœ‰ï¼ˆå¯æ‹–åŠ¨å®½åº¦ï¼‰ |

### 4.2 ä¸»é¢˜ç³»ç»Ÿ

- **Material Design 3** è®¾è®¡è¯­è¨€
- **åŠ¨æ€å–è‰²** (dynamic_color) æ”¯æŒ
- æ·±è‰²/æµ…è‰²/è·Ÿéšç³»ç»Ÿä¸‰ç§æ¨¡å¼

### 4.3 è¿·ä½ æ’­æ”¾å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚  â† å¯äº¤äº’è¿›åº¦æ¡
â”‚  ğŸµ å°é¢ â”‚ æ­Œæ›²åç§° - è‰ºæœ¯å®¶    ğŸ”€ ğŸ” â®ï¸ â–¶ï¸ â­ï¸  ğŸ”Šâ”â”â”â—â”â”â”     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 æ¡Œé¢ç«¯ä¸‰æ å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚                        â”‚                  â”‚
â”‚  å¯¼èˆªæ    â”‚       ä¸»å†…å®¹åŒº         â”‚   æ­Œæ›²è¯¦æƒ…é¢æ¿    â”‚
â”‚ (å¯æ”¶èµ·)  â”‚                        â”‚  (å¯æ‹–åŠ¨å®½åº¦)    â”‚
â”‚          â”‚                        â”‚                  â”‚
â”‚  é¦–é¡µ     â”‚                        â”‚  å°é¢            â”‚
â”‚  æ¢ç´¢     â”‚                        â”‚  UPä¸»ä¿¡æ¯        â”‚
â”‚  æœç´¢     â”‚                        â”‚  ç»Ÿè®¡æ•°æ®        â”‚
â”‚  éŸ³ä¹åº“   â”‚                        â”‚  ä¸‹ä¸€é¦–é¢„è§ˆ      â”‚
â”‚  è®¾ç½®     â”‚                        â”‚  ç®€ä»‹            â”‚
â”‚          â”‚                        â”‚  çƒ­é—¨è¯„è®º        â”‚
â”‚          â”‚                        â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. æŠ€æœ¯çº¦æŸ

### 5.1 æ€§èƒ½è¦æ±‚
| æŒ‡æ ‡ | è¦æ±‚ |
|------|------|
| å¯åŠ¨æ—¶é—´ | < 3 ç§’ |
| æ’­æ”¾å»¶è¿Ÿ | < 2 ç§’ï¼ˆç½‘ç»œæ­£å¸¸æ—¶ï¼‰ |
| é˜Ÿåˆ—æ“ä½œ | 1000 é¦–æ­Œæ›²æ—¶æµç•… |
| å†…å­˜å ç”¨ | < 300 MB |

### 5.2 ç¦»çº¿æ”¯æŒ
- å·²ä¸‹è½½æ­Œæ›²å¯å®Œå…¨ç¦»çº¿æ’­æ”¾
- é˜Ÿåˆ—å’Œæ­Œå•æ•°æ®æœ¬åœ°æŒä¹…åŒ–
- æ— ç½‘ç»œæ—¶ä¼˜é›…é™çº§ï¼ˆæ˜¾ç¤ºç¦»çº¿æç¤ºï¼‰

### 5.3 é”™è¯¯å¤„ç†
- éŸ³æºå¤±æ•ˆæ—¶è‡ªåŠ¨è·³è¿‡å¹¶æç¤º
- ç½‘ç»œé”™è¯¯æ—¶æ”¯æŒé‡è¯•
- ä¸‹è½½å¤±è´¥æ—¶ä¿ç•™ä»»åŠ¡å¯æ¢å¤

---

## 6. å¼€å‘è·¯çº¿å›¾

### Phase 1: åŸºç¡€æ¶æ„ âœ…
- [x] é¡¹ç›®åˆå§‹åŒ–
- [x] æ•°æ®åº“è®¾è®¡ (Isar)
- [x] åŸºç¡€ UI æ¡†æ¶
- [x] è·¯ç”±é…ç½® (go_router)

### Phase 2: æ ¸å¿ƒæ’­æ”¾ âœ…
- [x] éŸ³é¢‘æ’­æ”¾æœåŠ¡ (media_kit)
- [x] æ’­æ”¾é˜Ÿåˆ—ç®¡ç†
- [x] åŸºç¡€æ’­æ”¾æ§åˆ¶
- [x] è¿›åº¦æ¡å’Œæ—¶é—´æ˜¾ç¤º
- [x] ä¸´æ—¶æ’­æ”¾åŠŸèƒ½
- [x] é™éŸ³åˆ‡æ¢ï¼ˆå¸¦è®°å¿†ï¼‰

### Phase 3: éŸ³ä¹åº“ âœ…
- [x] æ­Œå• CRUD
- [x] æ­Œæ›²ç®¡ç†
- [x] æœç´¢åŠŸèƒ½
- [x] Bilibili å¯¼å…¥
- [x] YouTube å¯¼å…¥

### Phase 4: å®Œæ•´ UI âœ…
- [x] å“åº”å¼å¸ƒå±€ï¼ˆMobile/Tablet/Desktopï¼‰
- [x] ä¸»é¢˜ç³»ç»Ÿï¼ˆMaterial Design 3ï¼‰
- [x] æ¢ç´¢é¡µï¼ˆæ’è¡Œæ¦œï¼‰
- [x] æ­Œæ›²è¯¦æƒ…é¢æ¿ï¼ˆæ¡Œé¢ç«¯ï¼‰
- [x] è¿·ä½ æ’­æ”¾å™¨

### Phase 5: å¹³å°ç‰¹æ€§ âœ…
- [x] Android åå°æ’­æ”¾ (audio_service)
- [x] Android é€šçŸ¥æ æ§åˆ¶
- [x] Windows æ‰˜ç›˜ (tray_manager)
- [x] Windows SMTC åª’ä½“é”® (smtc_windows)
- [x] YouTube éŸ³æºé›†æˆ
- [x] YouTube Mix/Radio æ’­æ”¾
- [x] åº”ç”¨å†…æ›´æ–°
- [x] éŸ³é¢‘è´¨é‡è®¾ç½®
- [x] ä¸‹è½½ç³»ç»Ÿï¼ˆIsolate ä¸‹è½½ï¼‰

### Phase 6: ä¼˜åŒ–ä¸å®Œå–„ â³
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å…¨å±€å¿«æ·é”®è‡ªå®šä¹‰
- [ ] é”™è¯¯ç›‘æ§
- [ ] æ— éšœç¢æ”¯æŒ
- [ ] æ–‡æ¡£å®Œå–„

---

## 7. æœªæ¥æ‰©å±• (V2+)

ä»¥ä¸‹åŠŸèƒ½åœ¨ MVP ä¸­æš‚ä¸å®ç°ï¼Œä½†æ¶æ„è®¾è®¡æ—¶éœ€é¢„ç•™æ‰©å±•ç©ºé—´ï¼š

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| æ­Œè¯æ˜¾ç¤º | ä¸­ | ä»å¤–éƒ¨ API è·å–æ­Œè¯ |
| éŸ³é¢‘å¯è§†åŒ– | ä½ | é¢‘è°±å¯è§†åŒ–æ•ˆæœ |
| ç¡çœ å®šæ—¶å™¨ | ä½ | å®šæ—¶åœæ­¢æ’­æ”¾ |
| äº‘åŒæ­¥ | ä¸­ | è·¨è®¾å¤‡åŒæ­¥æ’­æ”¾é˜Ÿåˆ—å’Œæ­Œå• |
| æ›´å¤šå¹³å° | ä¸­ | iOSã€Linuxã€macOS |
| æ›´å¤šéŸ³æº | ä¸­ | SoundCloudã€ç½‘æ˜“äº‘ç­‰ |
| å‡è¡¡å™¨ | ä½ | éŸ³é¢‘å‡è¡¡è°ƒèŠ‚ |

---

## é™„å½•

### A. æœ¯è¯­è¡¨
| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| éŸ³æº | éŸ³é¢‘å†…å®¹çš„æ¥æºå¹³å° |
| å¯¼å…¥æ­Œå• | ä»å¤–éƒ¨å¹³å°åŒæ­¥çš„æ­Œå• |
| ç¦»çº¿ç¼“å­˜ | ä¸‹è½½åˆ°æœ¬åœ°çš„éŸ³é¢‘æ–‡ä»¶ |
| ä¸´æ—¶æ’­æ”¾ | ä¸ä¿®æ”¹é˜Ÿåˆ—çš„å•æ›²æ’­æ”¾æ¨¡å¼ |
| Mix æ¨¡å¼ | YouTube åŠ¨æ€æ— é™æ’­æ”¾åˆ—è¡¨ |
| SMTC | Windows System Media Transport Controls |

### B. å‚è€ƒèµ„æº
- [Flutter å®˜æ–¹æ–‡æ¡£](https://flutter.dev/docs)
- [Bilibili API](https://github.com/SocialSisterYi/bilibili-API-collect)
- [Material Design 3](https://m3.material.io/)
- [youtube_explode_dart](https://pub.dev/packages/youtube_explode_dart)